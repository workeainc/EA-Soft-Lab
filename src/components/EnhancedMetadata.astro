---
export interface Props {
  seo?: {
    metaTitle?: string;
    metaDescription?: string;
    keywords?: string[];
    canonicalUrl?: string;
    robotsDirective?: string;
    ogTitle?: string;
    ogDescription?: string;
    ogImage?: any;
    ogType?: string;
    twitterCard?: string;
    twitterTitle?: string;
    twitterDescription?: string;
    twitterImage?: any;
    structuredData?: {
      schemaType?: string;
      customSchema?: string;
    };
    hreflang?: Array<{
      language: string;
      url: string;
    }>;
    priority?: number;
    changeFrequency?: string;
    lastModified?: string;
  };
  fallbackTitle?: string;
  fallbackDescription?: string;
  fallbackKeywords?: string[];
  currentUrl?: string;
}

const {
  seo,
  fallbackTitle = "EA Soft Lab - Software Development Services",
  fallbackDescription = "Leading software development company specializing in web applications, mobile apps, and digital transformation solutions.",
  fallbackKeywords = ["software development", "web development", "mobile apps", "digital transformation"],
  currentUrl = Astro.url.href
} = Astro.props;

// Extract metadata with fallbacks
const title = seo?.metaTitle || fallbackTitle;
const description = seo?.metaDescription || fallbackDescription;
const keywords = seo?.keywords || fallbackKeywords;
const canonicalUrl = seo?.canonicalUrl || currentUrl;
const robotsDirective = seo?.robotsDirective || 'index,follow';

// Open Graph metadata
const ogTitle = seo?.ogTitle || title;
const ogDescription = seo?.ogDescription || description;
const ogType = seo?.ogType || 'website';

// Twitter Card metadata
const twitterCard = seo?.twitterCard || 'summary_large_image';
const twitterTitle = seo?.twitterTitle || ogTitle;
const twitterDescription = seo?.twitterDescription || ogDescription;

// Structured data
const structuredData = seo?.structuredData;
---

<!-- Enhanced Meta Tags -->
<meta name="title" content={title} />
<meta name="description" content={description} />
<meta name="keywords" content={keywords.join(', ')} />
<meta name="robots" content={robotsDirective} />
<link rel="canonical" href={canonicalUrl} />

<!-- Open Graph Meta Tags -->
<meta property="og:title" content={ogTitle} />
<meta property="og:description" content={ogDescription} />
<meta property="og:type" content={ogType} />
<meta property="og:url" content={currentUrl} />
<meta property="og:site_name" content="EA Soft Lab" />
{seo?.ogImage && (
  <meta property="og:image" content={seo.ogImage} />
)}

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content={twitterCard} />
<meta name="twitter:title" content={twitterTitle} />
<meta name="twitter:description" content={twitterDescription} />
<meta name="twitter:site" content="@easoftlab" />
<meta name="twitter:creator" content="@easoftlab" />
{seo?.twitterImage && (
  <meta name="twitter:image" content={seo.twitterImage} />
)}

<!-- Hreflang Tags for International SEO -->
{seo?.hreflang && seo.hreflang.length > 0 && (
  seo.hreflang.map((lang) => (
    <link rel="alternate" hreflang={lang.language} href={lang.url} />
  ))
)}

<!-- Additional SEO Meta Tags -->
{seo?.priority && (
  <meta name="priority" content={seo.priority.toString()} />
)}

{seo?.changeFrequency && (
  <meta name="change-frequency" content={seo.changeFrequency} />
)}

{seo?.lastModified && (
  <meta name="last-modified" content={seo.lastModified} />
)}

<!-- Custom Structured Data -->
{structuredData?.customSchema && (
  <script type="application/ld+json" set:html={structuredData.customSchema} />
)}

<!-- Enhanced Security Headers -->
<meta http-equiv="X-Content-Type-Options" content="nosniff" />
<meta http-equiv="X-Frame-Options" content="DENY" />
<meta http-equiv="X-XSS-Protection" content="1; mode=block" />
<meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />

<!-- Performance Optimization -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link rel="dns-prefetch" href="https://www.google-analytics.com" />
<link rel="dns-prefetch" href="https://www.googletagmanager.com" />

<!-- Enhanced Accessibility -->
<meta name="theme-color" content="#3B82F6" />
<meta name="msapplication-TileColor" content="#3B82F6" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="apple-mobile-web-app-title" content="EA Soft Lab" />

<!-- Enhanced SEO Schema -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": structuredData?.schemaType || "WebPage",
  "name": title,
  "description": description,
  "url": currentUrl,
  "mainEntity": {
    "@type": "Organization",
    "name": "EA Soft Lab",
    "url": "https://easoftlab.com",
    "logo": "https://easoftlab.com/images/logo.svg",
    "sameAs": [
      "https://linkedin.com/company/easoftlab",
      "https://twitter.com/easoftlab",
      "https://github.com/easoftlab"
    ]
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://easoftlab.com"
      }
    ]
  }
})} /> 